<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Asp.Net Core on Darrell Tunnell</title>
    <link>http://darrelltunnell.net/tags/asp.net-core/index.xml</link>
    <description>Recent content in Asp.Net Core on Darrell Tunnell</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>© Darrell Tunnell and darrelltunnell.net, 2017. Unauthorized use and/or duplication of this material without express and written permission from this site’s author and/or owner is strictly prohibited. Excerpts and links may be used, provided that full and clear credit is given to Darrell Tunnell and darrelltunnell.net with appropriate and specific direction to the original content.</copyright>
    <atom:link href="http://darrelltunnell.net/tags/asp.net-core/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>CSLA and ASP.NET Core</title>
      <link>http://darrelltunnell.net/blog/2017/01/24/csla-and-asp.net-core/</link>
      <pubDate>Tue, 24 Jan 2017 00:00:00 +0000</pubDate>
      
      <guid>http://darrelltunnell.net/blog/2017/01/24/csla-and-asp.net-core/</guid>
      <description>&lt;p&gt;I am a fan of CSLA and I recently came accross a need to make a shiny CSLA business layer work nicely within the context of an ASP.NET Core application.
This post is aimed at CSLA developers with a similar need.
As of the &lt;a href=&#34;https://www.nuget.org/packages/CSLA-Core/4.6.500&#34;&gt;current release&lt;/a&gt;, there are a few things that you will need to take care of in order to get CSLA working smoothly, and I will cover those in this post.
&lt;/p&gt;

&lt;h3 id=&#34;csla-applicationcontext&#34;&gt;Csla.ApplicationContext&lt;/h3&gt;

&lt;p&gt;CSLA developers should be familiar with &lt;code&gt;Csla.ApplicationContext&lt;/code&gt; which provides the means to access useful context, as well as the current &lt;code&gt;User&lt;/code&gt; / &lt;code&gt;IPrinciple&lt;/code&gt;.
However when running under ASP.NET Core, &lt;code&gt;Csla.ApplicationContext&lt;/code&gt; doesn&amp;rsquo;t work correctly - as CSLA decides that your application is not a web application (as &lt;code&gt;HttpContext.Current&lt;/code&gt; is null under ASP.NET Core) and so
it ends up storing things that should be stored in &lt;code&gt;HttpContext&lt;/code&gt; on the current &lt;code&gt;Thread&lt;/code&gt; instead.&lt;/p&gt;

&lt;p&gt;To overcome this, however, is pretty straight forward. You just need to implement an extensibility point that Rocky has provided, called an &lt;code&gt;IContextManager&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&#34;icontextmanager-for-asp-net-core&#34;&gt;IContextManager for ASP.NET Core.&lt;/h3&gt;

&lt;p&gt;Here is an implementation of an &lt;code&gt;IContextManager&lt;/code&gt; that resolves the &lt;code&gt;HttpContext&lt;/code&gt; using the &lt;code&gt;IHttpContextAccessor&lt;/code&gt; instead:&lt;/p&gt;

&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;  &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;summary&amp;gt;&lt;/span&gt;
    &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// Application context manager that uses HttpContextAccessor whenr esolving HttpContext&lt;/span&gt;
    &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// to store context values.&lt;/span&gt;
    &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;/summary&amp;gt;&lt;/span&gt;
    &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color: #0000FF; font-weight: bold&#34;&gt;HttpContextAccessorContextMananger&lt;/span&gt; : IContextManager
    {

        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color: #B00040&#34;&gt;string&lt;/span&gt; _localContextName = &lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;Csla.LocalContext&amp;quot;&lt;/span&gt;;
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color: #B00040&#34;&gt;string&lt;/span&gt; _clientContextName = &lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;Csla.ClientContext&amp;quot;&lt;/span&gt;;
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color: #B00040&#34;&gt;string&lt;/span&gt; _globalContextName = &lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;Csla.GlobalContext&amp;quot;&lt;/span&gt;;

        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;readonly&lt;/span&gt; IServiceProvider _serviceProvider;

        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color: #0000FF&#34;&gt;HttpContextAccessorContextMananger&lt;/span&gt;(IServiceProvider serviceProvider)
        {
            _serviceProvider = serviceProvider;
        }
      

        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;protected&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;virtual&lt;/span&gt; HttpContext &lt;span style=&#34;color: #0000FF&#34;&gt;GetHttpContext&lt;/span&gt;()
        {
            &lt;span style=&#34;color: #B00040&#34;&gt;var&lt;/span&gt; httpContextAccessor = (IHttpContextAccessor)_serviceProvider.GetService(&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;typeof&lt;/span&gt;(IHttpContextAccessor));
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;if&lt;/span&gt; (httpContextAccessor != &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;null&lt;/span&gt;)
            {
                &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;if&lt;/span&gt; (httpContextAccessor.HttpContext == &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;null&lt;/span&gt;)
                {
                    &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;//   Debugger.Break();&lt;/span&gt;
                }
                &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;return&lt;/span&gt; httpContextAccessor.HttpContext;
            }

            &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;// Debugger.Break();&lt;/span&gt;
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;null&lt;/span&gt;;
        }


        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// Gets a value indicating whether this&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// context manager is valid for use in&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// the current environment.&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color: #B00040&#34;&gt;bool&lt;/span&gt; IsValid
        {
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;get&lt;/span&gt;
            {
                &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color: #0000FF&#34;&gt;GetHttpContext&lt;/span&gt;() != &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;null&lt;/span&gt;;
            }
        }

        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// Gets the current principal.&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; System.Security.Principal.IPrincipal GetUser()
        {
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color: #0000FF&#34;&gt;GetHttpContext&lt;/span&gt;()?.User;
        }

        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// Sets the current principal.&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;param name=&amp;quot;principal&amp;quot;&amp;gt;Principal object.&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color: #0000FF&#34;&gt;SetUser&lt;/span&gt;(System.Security.Principal.IPrincipal principal)
        {
            &lt;span style=&#34;color: #B00040&#34;&gt;var&lt;/span&gt; context = GetHttpContext();
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;if&lt;/span&gt; (context != &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;null&lt;/span&gt;)
            {
                context.User = (ClaimsPrincipal)principal;
            }
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;else&lt;/span&gt;
            {
                &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;//  Debugger.Break();&lt;/span&gt;
            }
           
        }

        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// Gets the local context.&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; ContextDictionary &lt;span style=&#34;color: #0000FF&#34;&gt;GetLocalContext&lt;/span&gt;()
        {
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;return&lt;/span&gt; (ContextDictionary)GetHttpContext()?.Items[_localContextName];
        }

        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// Sets the local context.&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;param name=&amp;quot;localContext&amp;quot;&amp;gt;Local context.&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color: #0000FF&#34;&gt;SetLocalContext&lt;/span&gt;(ContextDictionary localContext)
        {
            &lt;span style=&#34;color: #B00040&#34;&gt;var&lt;/span&gt; context = GetHttpContext();
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;if&lt;/span&gt; (context != &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;null&lt;/span&gt;)
            {
                context.Items[_localContextName] = localContext;
            }
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;else&lt;/span&gt;
            {
              &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;//  Debugger.Break();&lt;/span&gt;
            }
        }

        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// Gets the client context.&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; ContextDictionary &lt;span style=&#34;color: #0000FF&#34;&gt;GetClientContext&lt;/span&gt;()
        {
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;return&lt;/span&gt; (ContextDictionary)GetHttpContext()?.Items[_clientContextName];
        }

        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// Sets the client context.&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;param name=&amp;quot;clientContext&amp;quot;&amp;gt;Client context.&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color: #0000FF&#34;&gt;SetClientContext&lt;/span&gt;(ContextDictionary clientContext)
        {
            &lt;span style=&#34;color: #B00040&#34;&gt;var&lt;/span&gt; context = GetHttpContext();
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;if&lt;/span&gt; (context != &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;null&lt;/span&gt;)
            {
                context.Items[_clientContextName] = clientContext;
            }
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;else&lt;/span&gt;
            {
              &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;//  Debugger.Break();&lt;/span&gt;
            }
        }

        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// Gets the global context.&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; ContextDictionary &lt;span style=&#34;color: #0000FF&#34;&gt;GetGlobalContext&lt;/span&gt;()
        {
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;return&lt;/span&gt; (ContextDictionary)GetHttpContext()?.Items[_globalContextName];
        }

        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;summary&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// Sets the global context.&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;/summary&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;param name=&amp;quot;globalContext&amp;quot;&amp;gt;Global context.&amp;lt;/param&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color: #0000FF&#34;&gt;SetGlobalContext&lt;/span&gt;(ContextDictionary globalContext)
        {
            &lt;span style=&#34;color: #B00040&#34;&gt;var&lt;/span&gt; context = GetHttpContext();
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;if&lt;/span&gt; (context != &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;null&lt;/span&gt;)
            {
                context.Items[_globalContextName] = globalContext;
            }
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;else&lt;/span&gt;
            {
              &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;//  Debugger.Break();&lt;/span&gt;
            }
        }
    }
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;h3 id=&#34;configuring-csla&#34;&gt;Configuring CSLA&lt;/h3&gt;

&lt;p&gt;Now that you have this implementation, you need to tell CSLA to use it. In the ASP.NET Core world, we are used to nice extension methods that we can use in our
&lt;code&gt;startup.cs&lt;/code&gt; classes, in order to configure things fluently.&lt;/p&gt;

&lt;p&gt;CSLA doesn&amp;rsquo;t provide one of these just yet, but we can create one fairly easily:&lt;/p&gt;

&lt;p&gt;&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color: #0000FF; font-weight: bold&#34;&gt;CslaConfiguration&lt;/span&gt;
    {
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;static&lt;/span&gt; IServiceCollection &lt;span style=&#34;color: #0000FF&#34;&gt;ConfigureCsla&lt;/span&gt;(&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;this&lt;/span&gt; IServiceCollection services, Action&amp;lt;CslaOptions, IServiceProvider&amp;gt; setupAction = &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;null&lt;/span&gt;)
        {
            services.AddSingleton&amp;lt;CslaOptions&amp;gt;((sp) =&amp;gt;
            {
                &lt;span style=&#34;color: #B00040&#34;&gt;var&lt;/span&gt; options = &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;new&lt;/span&gt; CslaOptions();
                setupAction?.Invoke(options, sp);
                &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;return&lt;/span&gt; options;
            });

            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;return&lt;/span&gt; services;
        }

        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;static&lt;/span&gt; IApplicationBuilder &lt;span style=&#34;color: #0000FF&#34;&gt;UseCsla&lt;/span&gt;(&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;this&lt;/span&gt; IApplicationBuilder appBuilder)
        {
            &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;// grab the options&lt;/span&gt;
            &lt;span style=&#34;color: #B00040&#34;&gt;var&lt;/span&gt; options = appBuilder.ApplicationServices.GetRequiredService&amp;lt;CslaOptions&amp;gt;();

            &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;// configure csla according to options.&lt;/span&gt;
            Csla.Server.FactoryDataPortal.FactoryLoader = options.ObjectFactoryLoader;
            Csla.ApplicationContext.WebContextManager = options.WebContextManager ?? &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;new&lt;/span&gt; HttpContextAccessorContextMananger(appBuilder.ApplicationServices);
            
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;return&lt;/span&gt; appBuilder;
        }

        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color: #0000FF; font-weight: bold&#34;&gt;CslaOptions&lt;/span&gt;
        {
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; IObjectFactoryLoader ObjectFactoryLoader { &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;set&lt;/span&gt;; }

            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; IContextManager WebContextManager { &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;set&lt;/span&gt;; }           

        }
    }
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/p&gt;

&lt;p&gt;So we can now configure CSLA in our &lt;code&gt;startup.cs&lt;/code&gt; like this:&lt;/p&gt;

&lt;p&gt;&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;    &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color: #0000FF; font-weight: bold&#34;&gt;Startup&lt;/span&gt;
    {              
       
        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;// This method gets called by the runtime. Use this method to add services to the container.&lt;/span&gt;
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color: #0000FF&#34;&gt;ConfigureServices&lt;/span&gt;(IServiceCollection services)
        {
            &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;// Configure Csla&lt;/span&gt;
           services.ConfigureCsla((options, sp) =&amp;gt; {               
                &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;// could configure other CSLA hooks / options here in future.&lt;/span&gt;
            });

        }

        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;// This method gets called by the runtime. Use this method to configure the HTTP request pipeline.&lt;/span&gt;
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color: #0000FF&#34;&gt;Configure&lt;/span&gt;(IApplicationBuilder app, IHostingEnvironment env, ILoggerFactory loggerFactory)
        {
            app.UseCookieAuthentication(&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;new&lt;/span&gt; CookieAuthenticationOptions
            {
                AuthenticationType = DefaultAuthenticationTypes.ApplicationCookie,
                LoginPath = &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;new&lt;/span&gt; PathString(&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;/Account/Login&amp;quot;&lt;/span&gt;)
            });
           app.UseCsla();      
        }        
    }
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/p&gt;

&lt;p&gt;CSLA &lt;code&gt;ApplicationContext&lt;/code&gt; should now behave correctly thanks to the custom &lt;code&gt;IContextManager&lt;/code&gt; for ASP.NET Core.&lt;/p&gt;

&lt;h3 id=&#34;conclusion&#34;&gt;Conclusion&lt;/h3&gt;

&lt;p&gt;I also went a few steps further in my particular application, to enable DI to flow from my ASP.NET Core &lt;code&gt;IServiceProvider&lt;/code&gt; into my CSLA business tier, but that&amp;rsquo;s a topic for another article.&lt;/p&gt;

&lt;p&gt;I suspect that Rocky will release improved support for ASP.NET Core in the future, so that this post becomes obsolete.
Until then, Bon Appétit!&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>ASPNET Core TagHelper&#39;s - A Better @addTagHelper type resolver</title>
      <link>http://darrelltunnell.net/blog/2016/07/25/aspnet-core-taghelpers---a-better-addtaghelper-type-resolver/</link>
      <pubDate>Mon, 25 Jul 2016 00:00:00 +0000</pubDate>
      
      <guid>http://darrelltunnell.net/blog/2016/07/25/aspnet-core-taghelpers---a-better-addtaghelper-type-resolver/</guid>
      <description>&lt;h3 id=&#34;what-s-this-about&#34;&gt;What&amp;rsquo;s this about?&lt;/h3&gt;

&lt;p&gt;This is about TagHelper&amp;rsquo;s in ASP.NET Core, and how to get more flexible &lt;code&gt;@addTagHelper&lt;/code&gt; directives.
&lt;/p&gt;

&lt;p&gt;Suppose your application loads some assemblies dynamically - for example, from a plugins folder, and those assemblies contain &lt;code&gt;TagHelper&lt;/code&gt;&amp;rsquo;s.&lt;/p&gt;

&lt;p&gt;In startup.cs you would have something like this to register your assemblies with the MVC parts system:&lt;/p&gt;

&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt; &lt;span style=&#34;color: #B00040&#34;&gt;var&lt;/span&gt; assy = Assembly.LoadFile(&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;C:\\SomePath\Plugin.Authentication.dll&amp;quot;&lt;/span&gt;);
 mvcBuilder.AddApplicationPart(assy);

 &lt;span style=&#34;color: #B00040&#34;&gt;var&lt;/span&gt; assy = Assembly.LoadFile(&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;C:\\SomePath\Plugin.Markdown.dll&amp;quot;&lt;/span&gt;);
 mvcBuilder.AddApplicationPart(assy);
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Now suppose you have a Razor View with some markup that can be targeted by those tag helpers:&lt;/p&gt;

&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #ffffff&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt; &amp;lt;&lt;span style=&#34;color: #007700&#34;&gt;plugin-authentication&lt;/span&gt; /&amp;gt;
 &amp;lt;&lt;span style=&#34;color: #007700&#34;&gt;plugin-markdown&lt;/span&gt; &lt;span style=&#34;color: #0000CC&#34;&gt;visible&lt;/span&gt;&lt;span style=&#34;color: #333333&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;background-color: #fff0f0&#34;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;/&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;If you run your application, those TagHelper&amp;rsquo;s won&amp;rsquo;t work.
This is because you don&amp;rsquo;t have any &lt;code&gt;@addTagHelper&lt;/code&gt; directive yet in your razor view, and so razor doesn&amp;rsquo;t know it should be using them. This is where things get a bit interesting!&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&#34;let-s-add-an-addtaghelper-directive&#34;&gt;Let&amp;rsquo;s add an &lt;code&gt;addTagHelper&lt;/code&gt; directive&lt;/h3&gt;

&lt;p&gt;So we add the directive to our __ViewImports.cshtml file:&lt;/p&gt;

&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;@addTagHelper &lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;*, Plugin.Markdown&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Now when we start our application, BOOM:&lt;/p&gt;

&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;1
2
3
4
5
6&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;An error occurred during the compilation of a resource required to process this request. Please review the following specific error details and modify your source code appropriately.

/Views/_ViewImports.cshtml

Cannot resolve TagHelper containing assembly &amp;#39;Plugin.Markdown&amp;#39;. Error: Could not load file or assembly &amp;#39;Plugin.Markdown&amp;#39; or one of its dependencies. The system cannot find the file specified.
@addTagHelper &lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;*, Plugin.Markdown&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;This is because by defualt MVC does not resolve &lt;code&gt;TagHelper&lt;/code&gt; assemblies registered with the parts system (atleast this is true as of RTM 1.0.0) so it complains when it processes that directive, saying it can&amp;rsquo;t find such an assembly - because it can only see assemblies that are in the bin folder by default. So it can&amp;rsquo;t see your plugin assembly.&lt;/p&gt;

&lt;h3 id=&#34;how-do-we-solve&#34;&gt;How do we solve?&lt;/h3&gt;

&lt;p&gt;Well if you add this line:&lt;/p&gt;

&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;mvcBuilder.AddTagHelpersAsServices();
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;That will register some replacement services that will check the application parts system when trying to resolve the tag helper assemblies based on the name provided by the addTagHelper directive.&lt;/p&gt;

&lt;p&gt;However - this now works but it&amp;rsquo;s still not ideal because we still have to add a directive for each &lt;code&gt;plugin&lt;/code&gt; before it will work on our page/s. So when someone develops a new plugin, it won&amp;rsquo;t work until we modify our &lt;code&gt;_ViewImports.cshtml&lt;/code&gt; file and add another line:&lt;/p&gt;

&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;@addTagHelper &lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;*, Plugin.Markdown&amp;quot;&lt;/span&gt;
@addTagHelper &lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;*, Plugin.Another&amp;quot;&lt;/span&gt;
@addTagHelper &lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;*, Plugin.YetAnother&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;This can be incredibly frustrating because if you are wanting an extensibile system where plugins can be installed on the fly, then they should just work without constant modifications to source code.&lt;/p&gt;

&lt;h3 id=&#34;so-can-we-do-better&#34;&gt;So Can We Do Better?&lt;/h3&gt;

&lt;p&gt;Yup. So here is my solution to this issue, and that is to allow &lt;code&gt;globbing&lt;/code&gt; to be supported in the &lt;code&gt;addTagHelper&lt;/code&gt; directive for the assembly name, just like it is for the TypeName portion.&lt;/p&gt;

&lt;p&gt;So this is how you do that.&lt;/p&gt;

&lt;h3 id=&#34;itaghelpertyperesolver&#34;&gt;ITagHelperTypeResolver&lt;/h3&gt;

&lt;p&gt;We need to create an &lt;code&gt;ITagHelperTypeResolver&lt;/code&gt; and implement it&amp;rsquo;s &lt;code&gt;Resolve&lt;/code&gt; method. This method takes the string provided by in the &lt;code&gt;addTagHelper&lt;/code&gt; directive and returns all &lt;code&gt;TagHelper&lt;/code&gt; type&amp;rsquo;s that are matches to that string. We will make our implementation support globbing on the assembly name so it can match &lt;code&gt;TagHelper&lt;/code&gt; types accross multiple assemblies registered with the &lt;code&gt;Application Parts&lt;/code&gt; system, instead of just from a single one.&lt;/p&gt;

&lt;p&gt;Here is my quick and dirty implementation, where I took a lot of the code from the microsoft implementation, and just added a few tweaks for globbing:&lt;/p&gt;

&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color: #0000FF; font-weight: bold&#34;&gt;AssemblyNameGlobbingTagHelperTypeResolver&lt;/span&gt; : ITagHelperTypeResolver
    {
       
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;readonly&lt;/span&gt; System.Reflection.TypeInfo ITagHelperTypeInfo = &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;typeof&lt;/span&gt;(ITagHelper).GetTypeInfo();

        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;protected&lt;/span&gt; TagHelperFeature Feature { &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;get&lt;/span&gt;; }

        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color: #0000FF&#34;&gt;AssemblyNameGlobbingTagHelperTypeResolver&lt;/span&gt;(ApplicationPartManager manager)
        {
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;if&lt;/span&gt; (manager == &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;null&lt;/span&gt;)
            {
                &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color: #0000FF&#34;&gt;ArgumentNullException&lt;/span&gt;(nameof(manager));
            }

            Feature = &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;new&lt;/span&gt; TagHelperFeature();
            manager.PopulateFeature(Feature);

            &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;// _manager = manager;&lt;/span&gt;

        }

        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;inheritdoc /&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; IEnumerable&amp;lt;Type&amp;gt; Resolve(
            &lt;span style=&#34;color: #B00040&#34;&gt;string&lt;/span&gt; name,
            SourceLocation documentLocation,
            ErrorSink errorSink)
        {
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;if&lt;/span&gt; (errorSink == &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;null&lt;/span&gt;)
            {
                &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color: #0000FF&#34;&gt;ArgumentNullException&lt;/span&gt;(nameof(errorSink));
            }

            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color: #B00040&#34;&gt;string&lt;/span&gt;.IsNullOrEmpty(name))
            {
                &lt;span style=&#34;color: #B00040&#34;&gt;var&lt;/span&gt; errorLength = name == &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;null&lt;/span&gt; ? &lt;span style=&#34;color: #666666&#34;&gt;1&lt;/span&gt; : Math.Max(name.Length, &lt;span style=&#34;color: #666666&#34;&gt;1&lt;/span&gt;);
                errorSink.OnError(
                    documentLocation,
                    &lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;Tag Helper Assembly Name Cannot Be Empty Or Null&amp;quot;&lt;/span&gt;,
                    errorLength);

                &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;return&lt;/span&gt; Type.EmptyTypes;
            }


            IEnumerable&amp;lt;TypeInfo&amp;gt; libraryTypes;
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;try&lt;/span&gt;
            {
                libraryTypes = GetExportedTypes(name);
            }
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;catch&lt;/span&gt; (Exception ex)
            {
                errorSink.OnError(
                    documentLocation,
                    &lt;span style=&#34;border: 1px solid #FF0000&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;Cannot Resolve Tag Helper Assembly: {name}, {ex.Message}&amp;quot;&lt;/span&gt;,
                    name.Length);

                &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;return&lt;/span&gt; Type.EmptyTypes;
            }

            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;return&lt;/span&gt; libraryTypes;

        }


        &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;/// &amp;lt;inheritdoc /&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;protected&lt;/span&gt; IEnumerable&amp;lt;System.Reflection.TypeInfo&amp;gt; GetExportedTypes(&lt;span style=&#34;color: #B00040&#34;&gt;string&lt;/span&gt; assemblyNamePattern)
        {
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;if&lt;/span&gt; (assemblyNamePattern == &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;null&lt;/span&gt;)
            {
                &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color: #0000FF&#34;&gt;ArgumentNullException&lt;/span&gt;(nameof(assemblyNamePattern));
            }

            &lt;span style=&#34;color: #B00040&#34;&gt;var&lt;/span&gt; results = &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;new&lt;/span&gt; List&amp;lt;System.Reflection.TypeInfo&amp;gt;();

            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color: #B00040&#34;&gt;var&lt;/span&gt; i = &lt;span style=&#34;color: #666666&#34;&gt;0&lt;/span&gt;; i &amp;lt; Feature.TagHelpers.Count; i++)
            {
                &lt;span style=&#34;color: #B00040&#34;&gt;var&lt;/span&gt; tagHelperAssemblyName = Feature.TagHelpers[i].Assembly.GetName();

                &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;if&lt;/span&gt; (assemblyNamePattern.Contains(&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;*&amp;quot;&lt;/span&gt;)) &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;// is it actually a pattern?&lt;/span&gt;
                {
                    &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;if&lt;/span&gt; (tagHelperAssemblyName.Name.Like(assemblyNamePattern))
                    {
                        results.Add(Feature.TagHelpers[i]);
                        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;continue&lt;/span&gt;;
                    }
                }

                &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;// not a pattern so treat as normal assembly name.&lt;/span&gt;
                &lt;span style=&#34;color: #B00040&#34;&gt;var&lt;/span&gt; assyName = &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;new&lt;/span&gt; AssemblyName(assemblyNamePattern);
                &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;if&lt;/span&gt; (AssemblyNameComparer.OrdinalIgnoreCase.Equals(tagHelperAssemblyName, assyName))
                {
                    results.Add(Feature.TagHelpers[i]);
                    &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;continue&lt;/span&gt;;
                }
            }

            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;return&lt;/span&gt; results;
        }

        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color: #0000FF; font-weight: bold&#34;&gt;AssemblyNameComparer&lt;/span&gt; : IEqualityComparer&amp;lt;AssemblyName&amp;gt;
        {
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;readonly&lt;/span&gt; IEqualityComparer&amp;lt;AssemblyName&amp;gt; OrdinalIgnoreCase = &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;new&lt;/span&gt; AssemblyNameComparer();

            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color: #0000FF&#34;&gt;AssemblyNameComparer&lt;/span&gt;()
            {
            }

            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color: #B00040&#34;&gt;bool&lt;/span&gt; &lt;span style=&#34;color: #0000FF&#34;&gt;Equals&lt;/span&gt;(AssemblyName x, AssemblyName y)
            {
                &lt;span style=&#34;color: #408080; font-style: italic&#34;&gt;// Ignore case because that&amp;#39;s what Assembly.Load does.&lt;/span&gt;
                &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color: #B00040&#34;&gt;string&lt;/span&gt;.Equals(x.Name, y.Name, StringComparison.OrdinalIgnoreCase) &amp;amp;&amp;amp;
                       &lt;span style=&#34;color: #B00040&#34;&gt;string&lt;/span&gt;.Equals(x.CultureName ?? &lt;span style=&#34;color: #B00040&#34;&gt;string&lt;/span&gt;.Empty, y.CultureName ?? &lt;span style=&#34;color: #B00040&#34;&gt;string&lt;/span&gt;.Empty, StringComparison.Ordinal);
            }

            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color: #B00040&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color: #0000FF&#34;&gt;GetHashCode&lt;/span&gt;(AssemblyName obj)
            {
                &lt;span style=&#34;color: #B00040&#34;&gt;var&lt;/span&gt; hashCode = &lt;span style=&#34;color: #666666&#34;&gt;0&lt;/span&gt;;
                &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;if&lt;/span&gt; (obj.Name != &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;null&lt;/span&gt;)
                {
                    hashCode ^= obj.Name.GetHashCode();
                }

                hashCode ^= (obj.CultureName ?? &lt;span style=&#34;color: #B00040&#34;&gt;string&lt;/span&gt;.Empty).GetHashCode();
                &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;return&lt;/span&gt; hashCode;
            }
        }


    }
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Now we just register this on startup, after we have registered &lt;code&gt;MVC&lt;/code&gt;:&lt;/p&gt;

&lt;p&gt;&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;  services.AddSingleton&amp;lt;ITagHelperTypeResolver, AssemblyNameGlobbingTagHelperTypeResolver&amp;gt;();
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/p&gt;

&lt;p&gt;Now we can just add one directive to our __ViewImports.cshtml file, like this:&lt;/p&gt;

&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;@addTagHelper &lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;*, Plugin.*&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Now that will include all TagHelpers that live in assemblies matching that glob. We can drop new plugins in and their tag helpers will light up automatically.&lt;/p&gt;

&lt;p&gt;You are welcome.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>ASP.NET 5 Projects - NuGet-NPM-Gulp-Bower-Jspm-Aurelia-Part2</title>
      <link>http://darrelltunnell.net/blog/2016/01/24/asp.net-5-projects---nuget-npm-gulp-bower-jspm-aurelia-part2/</link>
      <pubDate>Sun, 24 Jan 2016 00:00:00 +0000</pubDate>
      
      <guid>http://darrelltunnell.net/blog/2016/01/24/asp.net-5-projects---nuget-npm-gulp-bower-jspm-aurelia-part2/</guid>
      <description>&lt;p&gt;&lt;strong&gt;This post is part two of a series. For part one see &lt;a href=&#34;http://darrelltunnell.net/blog/2015/08/16/aurelia-and-asp-net-5-mvc/&#34;&gt;here&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;h3 id=&#34;part-2-replacing-bower-with-jspm&#34;&gt;Part 2 - Replacing Bower with JSPM&lt;/h3&gt;

&lt;p&gt;In &lt;a href=&#34;http://darrelltunnell.net/blog/2015/08/16/aurelia-and-asp-net-5-mvc&#34;&gt;part 1 of this series&lt;/a&gt; we created a shiny new ASP.NET 5 project, and I introduced some fundamentals.&lt;/p&gt;

&lt;p&gt;For reasons discussed in &lt;a href=&#34;http://darrelltunnell.net/blog/2015/08/16/aurelia-and-asp-net-5-mvc&#34;&gt;part 1&lt;/a&gt;, let&amp;rsquo;s now go ahead with our first task, which is to ditch Bower in favour of JSPM as our javascript package manager.
&lt;/p&gt;

&lt;h3 id=&#34;uninstall-bower&#34;&gt;Uninstall Bower&lt;/h3&gt;

&lt;p&gt;You will notice that your ASP.NET 5 application has a number of bower packages included by default:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://darrelltunnell.net/img/bowerpackages.PNG&#34; alt=&#34;bowerpackages.PNG&#34; /&gt;&lt;/p&gt;

&lt;p&gt;First, let&amp;rsquo;s uninstall Bower. In your project is a &lt;code&gt;Bower.json&lt;/code&gt; file. Delete it! (If you can&amp;rsquo;t see it in Solution Explorer, you might need to &amp;lsquo;show all files&amp;rsquo;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://darrelltunnell.net/img/bowerjson.PNG&#34; alt=&#34;bowerjson.PNG&#34; /&gt;&lt;/p&gt;

&lt;p&gt;When you install &lt;code&gt;Bower&lt;/code&gt; packages, they are installed under the &amp;ldquo;lib&amp;rdquo; folder within your &lt;code&gt;wwwroot&lt;/code&gt; directory. So, let&amp;rsquo;s now delete this lib folder which will delete all of these packages.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://darrelltunnell.net/img/wwwrootlibfolder.PNG&#34; alt=&#34;wwwrootlibfolder.PNG&#34; /&gt;&lt;/p&gt;

&lt;p&gt;After those changes, your project should look something like this:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://darrelltunnell.net/img/projectremovedbower.PNG&#34; alt=&#34;projectremovedbower.PNG&#34; /&gt;&lt;/p&gt;

&lt;p&gt;With Bower gone and those javascript / css packages deleted, what happens if we run the application now? Let&amp;rsquo;s run it and find out..&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://darrelltunnell.net/img/runappbowerremoved.PNG&#34; alt=&#34;runappbowerremoved.PNG&#34; /&gt;&lt;/p&gt;

&lt;p&gt;As you can see, there are now errors displayed in the browser, and our site looks awful. This makes sense - our application is referencing javascript and css files that used to live in the lib folder, and now they are no longer found because we deleted them.&lt;/p&gt;

&lt;p&gt;To fix this situation we&amp;rsquo;ll need to add these packages back to our application, using &lt;code&gt;JSPM&lt;/code&gt;, and then fix up the way our application is &lt;code&gt;loading&lt;/code&gt; these dependencies (javascript, css files) at runtime.&lt;/p&gt;

&lt;h3 id=&#34;install-jspm&#34;&gt;Install JSPM&lt;/h3&gt;

&lt;p&gt;JSPM can be installed as a local &lt;code&gt;NPM&lt;/code&gt; package.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Open &lt;code&gt;Package.json&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Add &lt;code&gt;JSPM&lt;/code&gt; and whatever the latest version is:&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&#34;http://darrelltunnell.net/img/addjspmnodejspackage.PNG&#34; alt=&#34;addjspmnodejspackage.PNG&#34; /&gt;&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Save the file.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;The &lt;code&gt;NPM&lt;/code&gt; package for &lt;code&gt;JSPM&lt;/code&gt; should now be downloaded and installed into your project. You will see that the package is installed into the &amp;ldquo;node_modules&amp;rdquo; folder within your project.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://darrelltunnell.net/img/nodemodulesfolderjspm.PNG&#34; alt=&#34;nodemodulesfolderjspm.PNG&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;configure-jspm&#34;&gt;Configure JSPM&lt;/h3&gt;

&lt;p&gt;Now that the &lt;code&gt;JSPM&lt;/code&gt; package has been installed, we need to configure &lt;code&gt;JSPM&lt;/code&gt;.
The way to do this, is a little bit fiddely, as you have to drop to the command line - there is no fancy support for &lt;code&gt;JSPM&lt;/code&gt; in Visual Studio at the moment like there is for &lt;code&gt;Bower&lt;/code&gt;.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Open a &lt;code&gt;command prompt&lt;/code&gt; window, and &lt;code&gt;CD&lt;/code&gt; to your project directory&lt;/li&gt;
&lt;li&gt;Type &lt;code&gt;jspm init&lt;/code&gt; and hit enter.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&#34;http://darrelltunnell.net/img/commandlinejspminit.PNG&#34; alt=&#34;commandlinejspminit.PNG&#34; /&gt;&lt;/p&gt;

&lt;p&gt;You will now be asked a series of questions. At the end of answering these questions, the relevent &lt;code&gt;config&lt;/code&gt; will be produced within the project.&lt;/p&gt;

&lt;p&gt;Here are the answers. Some of them you can just hit enter without typing anything, and the default value will be used.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://darrelltunnell.net/img/jspminit.PNG&#34; alt=&#34;jspminit.PNG&#34; /&gt;&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;ll quickly run through each option briefly.. But you should defer to the &lt;code&gt;JSPM&lt;/code&gt; documentation site for further clarifications.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&amp;ldquo;&lt;strong&gt;Would you like jspm to prefix the jspm package.json properties under jspm?&lt;/strong&gt;&amp;ldquo;
We answer yes to this (the default) and this just means that JSPM will store its project configuration within a &amp;ldquo;jspm&amp;rdquo; section in our existing &lt;code&gt;package.json&lt;/code&gt; file.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&amp;ldquo;&lt;strong&gt;Enter server baseURL (public folder path)&lt;/strong&gt;&amp;ldquo;
The word URL is a bit confusing here. This is the relative path to your &amp;ldquo;public&amp;rdquo; folder within the project. By public folder, we mean the folder that will serve up static files and is therefore accessible to a browser. We need to set this to the path to our &lt;code&gt;wwwroot&lt;/code&gt; directory. So the value we set for this question is &lt;code&gt;./wwwroot&lt;/code&gt; as the value is relative to the current (project) directory.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&amp;ldquo;&lt;strong&gt;Enter jspm packages folder [wwwroot\jspm_packages]&lt;/strong&gt;&amp;ldquo;
We accept the default value for this question. Previously, our Bower packages were installed under &lt;code&gt;wwwroot\lib&lt;/code&gt; folder, so if you want to keep this consistent you could change this value to &lt;code&gt;wwwroot\lib&lt;/code&gt;. I however am happy to keep the default.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&amp;ldquo;&lt;strong&gt;Enter config file path [wwwroot\config.js]&lt;/strong&gt;&amp;ldquo;
This is the path to where you would like the config javascript file to be placed. Remember, &lt;code&gt;JSPM&lt;/code&gt; is not just a package manager in a the sense of allowing you to adopt packages at &lt;code&gt;design time&lt;/code&gt;. It also has features that are used your application when it runs. This means it has a &lt;code&gt;config&lt;/code&gt; file (a javascript file) that your application will actually need to reference at runtime. This config file must therefore be placed in a directory that can be served up. We accept the default value (wwwroot\config.js)&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&amp;ldquo;&lt;strong&gt;Configuration file wwwroot\config.js doesn&amp;rsquo;t exist, create it? [yes]&lt;/strong&gt;&amp;rdquo;
We accept the default which is &lt;code&gt;yes&lt;/code&gt; as we want it to create this config file for us.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&amp;ldquo;&lt;strong&gt;Enter client baseURL (public folder URL) [/]&lt;/strong&gt;&amp;ldquo;
This is the URL or path that the browser uses to browse to the public folder (wwwroot). We accept the default value, because our public folder (wwwroot) is served up as the root path (&amp;ldquo;/&amp;rdquo;).&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&amp;ldquo;&lt;strong&gt;Do you wish to use a transpiler? [yes]&lt;/strong&gt;&amp;ldquo;
We accept the default answer of &amp;ldquo;yes&amp;rdquo; because transpilers are awesome. They allow us to write javascript using the latest language specifications, and then they &amp;ldquo;transpile&amp;rdquo; that javascript so that it can run in browsers that don&amp;rsquo;t support the latest language specifications yet.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&amp;ldquo;&lt;strong&gt;Which ES6 transpiler would you like to use, Babel, Typescript, or Traceur? [babel]&lt;/strong&gt;&amp;ldquo;
For the purposes of this blog, I am accepting the default of &amp;ldquo;Babel&amp;rdquo;.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;The transpiler will just allow us to write javascript using ES6 language features, and this will be transpiled to run in browsers that don&amp;rsquo;t support ES6 yet.&lt;/p&gt;

&lt;h3 id=&#34;installing-jspm-packages&#34;&gt;Installing JSPM Packages&lt;/h3&gt;

&lt;p&gt;Now that we have &lt;code&gt;JSPM&lt;/code&gt; configured, it&amp;rsquo;s time to install those packages that we previously had installed via &lt;code&gt;Bower&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Back in the &lt;code&gt;command prompt&lt;/code&gt; run the following commands:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;code&gt;jspm install jquery&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;jspm install jquery-validation&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;jspm install github:aspnet/jquery-validation-unobtrusive&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;jspm install bootstrap&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Once that is done, those packages will now be installed under your &lt;code&gt;wwwroot\jspm_packages&lt;/code&gt; folder:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://darrelltunnell.net/img/jspmpackages.PNG&#34; alt=&#34;jspmpackages.PNG&#34; /&gt;&lt;/p&gt;

&lt;p&gt;The next step is to fix up our MVC application so that it loads our javascript and css using the &lt;code&gt;module loader&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&#34;transitioning-to-modules&#34;&gt;Transitioning to Modules.&lt;/h3&gt;

&lt;p&gt;The changes we have been making up until now, have been about managing our packages in our project at design time. This next step is about making changes to our application so that rather than including javascript and css files directly into particular pages, we instead, write &amp;ldquo;modular&amp;rdquo; javascript, that declares any dependencies it has, and then allow a &lt;code&gt;module loader&lt;/code&gt; (&lt;code&gt;SystemJS&lt;/code&gt;) to satisfy those dependencies for us at runtime by loading any needed javascript / css dependencies that our module requires.&lt;/p&gt;

&lt;p&gt;If this sounds overwhelming, don&amp;rsquo;t worry, it&amp;rsquo;s simple once you get your head around the basic concept. Hopefully things will become more clear as we continue.&lt;/p&gt;

&lt;p&gt;First, we need to include the module loader itself, and it&amp;rsquo;s configuration file, into our application.&lt;/p&gt;

&lt;p&gt;If you open &lt;code&gt;_Layout.cshtml&lt;/code&gt; you will see a section like this:&lt;/p&gt;

&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;environment&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;names=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;Development&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;script&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;src=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;~/lib/jquery/dist/jquery.js&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;script&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;src=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;~/lib/bootstrap/dist/js/bootstrap.js&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;script&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;src=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;~/js/site.js&amp;quot;&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;asp-append-version=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;/environment&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;environment&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;names=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;Staging,Production&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;script&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;src=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;https://ajax.aspnetcdn.com/ajax/jquery/jquery-2.1.4.min.js&amp;quot;&lt;/span&gt;
                    &lt;span style=&#34;color: #7D9029&#34;&gt;asp-fallback-src=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;~/lib/jquery/dist/jquery.min.js&amp;quot;&lt;/span&gt;
                    &lt;span style=&#34;color: #7D9029&#34;&gt;asp-fallback-test=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;window.jQuery&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;script&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;src=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;https://ajax.aspnetcdn.com/ajax/bootstrap/3.3.5/bootstrap.min.js&amp;quot;&lt;/span&gt;
                    &lt;span style=&#34;color: #7D9029&#34;&gt;asp-fallback-src=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;~/lib/bootstrap/dist/js/bootstrap.min.js&amp;quot;&lt;/span&gt;
                    &lt;span style=&#34;color: #7D9029&#34;&gt;asp-fallback-test=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;window.jQuery &amp;amp;&amp;amp; window.jQuery.fn &amp;amp;&amp;amp; window.jQuery.fn.modal&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
            &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;script&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;src=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;~/js/site.min.js&amp;quot;&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;asp-append-version=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;/environment&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Let&amp;rsquo;s comment out that whole section and replace it with this:&lt;/p&gt;

&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;script&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;src=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;~/jspm_packages/system.js&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;script&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;src=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;~/config.js&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;System.import(&amp;quot;js/site&amp;quot;);&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;At this point, let&amp;rsquo;s run the application!&lt;/p&gt;

&lt;p&gt;You should now be able to see that we no longer get any errors about failing to load  javascript files &lt;code&gt;jquery.js&lt;/code&gt; and &lt;code&gt;bootstrap.js&lt;/code&gt;. In fact, &lt;strong&gt;those javascript files are not being loaded anymore.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://darrelltunnell.net/img/jspmmissingcss.PNG&#34; alt=&#34;jspmmissingcss.PNG&#34; /&gt;&lt;/p&gt;

&lt;h4 id=&#34;why-aren-t-we-loading-jquery-and-bootstrap-anymore&#34;&gt;Why aren&amp;rsquo;t we loading JQuery and Bootstrap anymore?&lt;/h4&gt;

&lt;p&gt;We are no longer directly including the &lt;code&gt;bootstrap&lt;/code&gt; and &lt;code&gt;jquery&lt;/code&gt; scripts into our &lt;code&gt;_Layout.cshtml&lt;/code&gt; file, so they aren&amp;rsquo;t being loaded! So we aren&amp;rsquo;t seeing any 404&amp;rsquo;s anymore within the browser console window - which is good, but don&amp;rsquo;t we need those files for our site to function?&lt;/p&gt;

&lt;p&gt;This is the nature of &lt;code&gt;modular&lt;/code&gt; javascript. What we are in the process of transitioning to now, is a Modular concept, where &lt;code&gt;bootstrap&lt;/code&gt; and &lt;code&gt;jquery&lt;/code&gt; are modules that will only be loaded, if some other module that we are loading via the module loader, requires them as dependencies.&lt;/p&gt;

&lt;p&gt;With that in mind, let&amp;rsquo;s look at the module we are currently loading via the module loader. It&amp;rsquo;s one called &lt;code&gt;js/site&lt;/code&gt;&lt;/p&gt;

&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #666666&#34;&gt;&amp;lt;&lt;/span&gt;script&lt;span style=&#34;color: #666666&#34;&gt;&amp;gt;&lt;/span&gt;System.&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;import&lt;/span&gt;(&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;js/site&amp;quot;&lt;/span&gt;);&lt;span style=&#34;color: #666666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;border: 1px solid #FF0000&#34;&gt;/script&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;This resolves (thanks to the &lt;code&gt;config.js&lt;/code&gt; file) to the &lt;code&gt;js/site.js&lt;/code&gt; file in our &lt;code&gt;wwwroot&lt;/code&gt; directory. This file is currently empty, meaning it also has no dependencies declared in it for any other modules. This is why the module loader no longer bothers to load &lt;code&gt;JQuery&lt;/code&gt; or &lt;code&gt;Bootstrap&lt;/code&gt; anymore.&lt;/p&gt;

&lt;p&gt;This is good, because we are not including any javascript or css by default anymore, until its actually required by something (with the exception of the module loader, and config.js file iteself).&lt;/p&gt;

&lt;p&gt;Therefore, as our &lt;code&gt;js/site&lt;/code&gt; module is being loaded in our &lt;code&gt;_Layout.cshtml&lt;/code&gt; file - which means it&amp;rsquo;s going to be loaded on &lt;strong&gt;every page&lt;/strong&gt;, we can &amp;ldquo;force&amp;rdquo; JQuery and Bootstrap to be loaded on every page, by decalring them as depencies for our module. This could be viewed as a bit of a cheat as really we don&amp;rsquo;t want to load dependencies just for the sake of it, we only want to load them if they are actually used.&lt;/p&gt;

&lt;p&gt;So, let&amp;rsquo;s now assume that we are willing to load &lt;code&gt;JQuery&lt;/code&gt;, and &lt;code&gt;Bootstrap&lt;/code&gt; as a dependency for every page:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Open &lt;code&gt;site.js&lt;/code&gt; and insert the following code, then save it an re-run the application:&lt;/li&gt;
&lt;/ol&gt;

&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;import&lt;/span&gt; $ from &lt;span style=&#34;color: #BA2121&#34;&gt;&amp;#39;jquery&amp;#39;&lt;/span&gt;;
&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;import&lt;/span&gt; bootstrap from &lt;span style=&#34;color: #BA2121&#34;&gt;&amp;#39;bootstrap&amp;#39;&lt;/span&gt;;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;This is &lt;code&gt;ES6&lt;/code&gt; syntax for declaring a module dependency.&lt;/p&gt;

&lt;p&gt;You should now see that &lt;code&gt;JQuery&lt;/code&gt; and &lt;code&gt;Bootstrap&lt;/code&gt; are loaded on every page:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://darrelltunnell.net/img/jspmjqueryandbootstrapdependency.PNG&#34; alt=&#34;jspmjqueryandbootstrapdependency.PNG&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;what-about-css&#34;&gt;What about CSS&lt;/h3&gt;

&lt;p&gt;Now that we have got our javascript files loading again, we are still left with 404&amp;rsquo;s for the bootstrap.css file.&lt;/p&gt;

&lt;p&gt;Well we can use JSPM for CSS too, but we need to install the &lt;code&gt;CSS&lt;/code&gt; plugin.&lt;/p&gt;

&lt;h4 id=&#34;installing-the-css-plugin-for-jspm&#34;&gt;Installing the CSS plugin for JSPM&lt;/h4&gt;

&lt;p&gt;Back in the &lt;code&gt;command prompt&lt;/code&gt; in your project directory, run the following&lt;/p&gt;

&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;jspm install css
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Now go back to your &lt;code&gt;site.js&lt;/code&gt; file, and add an import for the bootstrap.css. It should now look like this:&lt;/p&gt;

&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;import&lt;/span&gt; $ from &lt;span style=&#34;color: #BA2121&#34;&gt;&amp;#39;jquery&amp;#39;&lt;/span&gt;;
&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;import&lt;/span&gt; bootstrap from &lt;span style=&#34;color: #BA2121&#34;&gt;&amp;#39;bootstrap&amp;#39;&lt;/span&gt;;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Lastly, in &lt;code&gt;_Layout.cshtml&lt;/code&gt;, comment out the link to the old - non existent, bootstrap.css file:&lt;/p&gt;

&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;environment&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;names=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;Development&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;gt;&lt;/span&gt;
        @*&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;link&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;rel=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;stylesheet&amp;quot;&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;href=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;~/lib/bootstrap/dist/css/bootstrap.css&amp;quot;&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;/&amp;gt;&lt;/span&gt;*@
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;link&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;rel=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;stylesheet&amp;quot;&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;href=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;~/css/site.css&amp;quot;&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;/environment&amp;gt;&lt;/span&gt;
    &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;environment&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;names=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;Staging,Production&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;gt;&lt;/span&gt;
        @*&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;link&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;rel=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;stylesheet&amp;quot;&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;href=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;https://ajax.aspnetcdn.com/ajax/bootstrap/3.3.5/css/bootstrap.min.css&amp;quot;&lt;/span&gt;
            &lt;span style=&#34;color: #7D9029&#34;&gt;asp-fallback-href=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;~/lib/bootstrap/dist/css/bootstrap.min.css&amp;quot;&lt;/span&gt;&lt;span style=&#34;border: 1px solid #FF0000&#34;&gt;*@&lt;/span&gt;
        &lt;span style=&#34;color: #7D9029&#34;&gt;asp-fallback-test-class=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;sr-only&amp;quot;&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;asp-fallback-test-property=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;position&amp;quot;&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;asp-fallback-test-value=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;absolute&amp;quot;&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;link&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;rel=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;stylesheet&amp;quot;&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;href=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;~/css/site.min.css&amp;quot;&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;asp-append-version=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;true&amp;quot;&lt;/span&gt; &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;/environment&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Now run your application!&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://darrelltunnell.net/img/jspmnoerrors.PNG&#34; alt=&#34;jspmnoerrors.PNG&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Wahoo! We now have no errors in the console window, our javascript and css is being loaded - and our application looks ok again.&lt;/p&gt;

&lt;h4 id=&#34;flash-of-unstyled-content&#34;&gt;Flash of unstyled content&lt;/h4&gt;

&lt;p&gt;You may notice that using the CSS plugin, your page is displayed in an unstyled form for a brief moment, whilst the CSS file is loaded asynchronosuly. This is known as a &lt;a href=&#34;http://www.techrepublic.com/blog/web-designer/how-to-prevent-flash-of-unstyled-content-on-your-websites/&#34;&gt;Flash of Unstyled Content&lt;/a&gt; and is a problem with using the CSS plugin at present - &lt;a href=&#34;https://github.com/systemjs/plugin-css/issues/57&#34;&gt;see here&lt;/a&gt;. Hopefully this will be addressed in the future, but in the meantime, feel free not to use the CSS Plugin if this is an issue, you can instead just directly reference the &lt;code&gt;Bootstrap.css&lt;/code&gt; file in the &lt;code&gt;_Layout.cshtml&lt;/code&gt; file as before, but from its new location under the &lt;code&gt;jspm_packages&lt;/code&gt; directory.&lt;/p&gt;

&lt;h3 id=&#34;finishing-touches-validationscripspartial-cshtml&#34;&gt;Finishing Touches - &lt;code&gt;_ValidationScripsPartial.cshtml&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;Our application is running again, but you may notice a few of the pages have errors.&lt;/p&gt;

&lt;p&gt;If you click on &amp;ldquo;Register&amp;rdquo; link for example you will see these errors in the browser console window:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://darrelltunnell.net/img/jspmregisterpageproblems.PNG&#34; alt=&#34;jspmregisterpageproblems.PNG&#34; /&gt;&lt;/p&gt;

&lt;p&gt;This is because many of the views within our MVC application are rendering a partial called &lt;code&gt;_ValidationScriptsPartial.cshtml&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;For example, if you look at the bottom of &lt;code&gt;Register.cshtml&lt;/code&gt;, you will see the following:&lt;/p&gt;

&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;@section Scripts {
    &lt;span style=&#34;border: 1px solid #FF0000&#34;&gt;@&lt;/span&gt;{ &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;await&lt;/span&gt; Html.RenderPartialAsync(&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;_ValidationScriptsPartial&amp;quot;&lt;/span&gt;); }
}
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;If you look at the contents of &lt;code&gt;_ValidationScriptsPartial&lt;/code&gt; we can see that it is actually including additional scripts onto the page:&lt;/p&gt;

&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;environment&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;names=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;Development&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;script&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;src=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;~/lib/jquery-validation/dist/jquery.validate.js&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
    &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;script&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;src=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.js&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;/environment&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;environment&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;names=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;Staging,Production&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;script&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;src=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;https://ajax.aspnetcdn.com/ajax/jquery.validate/1.14.0/jquery.validate.min.js&amp;quot;&lt;/span&gt;
            &lt;span style=&#34;color: #7D9029&#34;&gt;asp-fallback-src=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;~/lib/jquery-validation/dist/jquery.validate.min.js&amp;quot;&lt;/span&gt;
            &lt;span style=&#34;color: #7D9029&#34;&gt;asp-fallback-test=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;window.jQuery &amp;amp;&amp;amp; window.jQuery.validator&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
    &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;script&lt;/span&gt; &lt;span style=&#34;color: #7D9029&#34;&gt;src=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;https://ajax.aspnetcdn.com/ajax/mvc/5.2.3/jquery.validate.unobtrusive.min.js&amp;quot;&lt;/span&gt;
            &lt;span style=&#34;color: #7D9029&#34;&gt;asp-fallback-src=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js&amp;quot;&lt;/span&gt;
            &lt;span style=&#34;color: #7D9029&#34;&gt;asp-fallback-test=&lt;/span&gt;&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;window.jQuery &amp;amp;&amp;amp; window.jQuery.validator &amp;amp;&amp;amp; window.jQuery.validator.unobtrusive&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;&amp;lt;/environment&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;As you can see, depending upon the environment that ASP.NET determines your application is running on, this renders some script includes to particular js files, used for forms validation. These were previoulsy located within &lt;code&gt;Bower&lt;/code&gt; packages, that we have deleted.&lt;/p&gt;

&lt;p&gt;To correct this, we&amp;rsquo;ll just need to instruct the module loader to load the &lt;code&gt;jquery.validate.unobtrusive&lt;/code&gt; module instead. Notice that you don&amp;rsquo;t need to also instruct the module loader to load the &lt;code&gt;jquery.validate&lt;/code&gt; module, because &lt;code&gt;jquery.validate&lt;/code&gt; is a dependency of &lt;code&gt;jquery.validate.unobtrusive&lt;/code&gt; so the module loader will resolve it automatically.&lt;/p&gt;

&lt;p&gt;So change the contents of &lt;code&gt;_ValidationScriptsPartial.cshtml&lt;/code&gt; to this:&lt;/p&gt;

&lt;table class=&#34;highlighttable&#34;&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&#34;linenodiv&#34; style=&#34;background-color: #f0f0f0; padding-right: 10px&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f8f8f8&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #666666&#34;&gt;&amp;lt;&lt;/span&gt;script&lt;span style=&#34;color: #666666&#34;&gt;&amp;gt;&lt;/span&gt;System.&lt;span style=&#34;color: #008000; font-weight: bold&#34;&gt;import&lt;/span&gt;(&lt;span style=&#34;color: #BA2121&#34;&gt;&amp;quot;aspnet/jquery-validation-unobtrusive&amp;quot;&lt;/span&gt;);&lt;span style=&#34;color: #666666&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;border: 1px solid #FF0000&#34;&gt;/script&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;And now - everything is working!&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://darrelltunnell.net/img/jspmallworking.PNG&#34; alt=&#34;jspmallworking.PNG&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;recap&#34;&gt;Recap&lt;/h3&gt;

&lt;p&gt;In this blog post, we took an out of the box ASP.NET 5 MVC application that we created in &lt;a href=&#34;http://darrelltunnell.net/blog/2015/08/16/aurelia-and-asp-net-5-mvc/&#34;&gt;part 1&lt;/a&gt;, and replaced &lt;code&gt;Bower&lt;/code&gt; with &lt;code&gt;JSPM&lt;/code&gt;. We changed the way our application resolves it&amp;rsquo;s javascript and css files, to use a &lt;code&gt;module loader&lt;/code&gt; instead.&lt;/p&gt;

&lt;p&gt;We also saw that using the module loader to load CSS currently results in a &amp;ldquo;flash of unstyled content&amp;rdquo; issue, and so if that&amp;rsquo;s an issue for your application then it&amp;rsquo;s probably best to stick to directly linking to your css files as before, for the time being. That&amp;rsquo;s a decision for you to make!&lt;/p&gt;

&lt;p&gt;In the next blog post/s in this series, I will attempt to cover:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Creating a basic Aurelia application on the Home page.&lt;/li&gt;
&lt;li&gt;Introducing Linting, Bundling, and Minification into the build process, using Gulp.&lt;/li&gt;
&lt;li&gt;Implementing &amp;ldquo;Automatic Browser Refresh&amp;rdquo; so our page refreshes as we make changes to javascript and css files.&lt;/li&gt;
&lt;/ol&gt;</description>
    </item>
    
    <item>
      <title>ASP.NET 5 Projects - NuGet-NPM-Gulp-Bower-Jspm-Aurelia</title>
      <link>http://darrelltunnell.net/blog/2015/08/16/asp.net-5-projects---nuget-npm-gulp-bower-jspm-aurelia/</link>
      <pubDate>Sun, 16 Aug 2015 00:00:00 +0000</pubDate>
      
      <guid>http://darrelltunnell.net/blog/2015/08/16/asp.net-5-projects---nuget-npm-gulp-bower-jspm-aurelia/</guid>
      <description>&lt;p&gt;&lt;strong&gt;This post is part 1 of a series. Part 2 is &lt;a href=&#34;http://darrelltunnell.net/blog/2016/01/24/aurelia-and-asp-net-5-mvc-part2/&#34;&gt;here&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;h3 id=&#34;asp-a-sea-of-packages-net-5&#34;&gt;ASP (A Sea of Packages).NET 5&lt;/h3&gt;

&lt;p&gt;When you create a new ASP.NET 5 project, you will see all sorts of new-ness. I am going to guide you, the uninitiated ASP.NET 5 web developer, through creating your first ASP.NET 5 MVC application, but we won&amp;rsquo;t stop there. In the next post of this series, we will then enhance the project with a number of features:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Bundling and Minification.&lt;/li&gt;
&lt;li&gt;Auto browser refresh (as you make changes to files during development)&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;In addition, I will touch upon important tooling that you need to be aware of:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;NPM&lt;/li&gt;
&lt;li&gt;Bower and why we are going to replace it with Jspm&lt;/li&gt;
&lt;li&gt;Gulp - and why is it useful&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;To be able to do all of this, we will be creating an ASP.NET MVC 5 project, and then we will be using &lt;a href=&#34;http://aurelia.io/&#34;&gt;Aurelia&lt;/a&gt; to run an Aurelia application on Home page (Index.cshtml)
&lt;/p&gt;

&lt;h3 id=&#34;new-project&#34;&gt;New Project&lt;/h3&gt;

&lt;p&gt;The first step on our quest is simply to create a new ASP.NET application. I am sure you know the drill:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;In VS 2015, File &amp;ndash;&amp;gt; New Project&lt;/li&gt;
&lt;li&gt;&amp;ldquo;ASP.NET Web Application&amp;rdquo;
&lt;img src=&#34;http://darrelltunnell.net/img/new aspnet project.PNG&#34; alt=&#34;new aspnet project.PNG&#34; /&gt;&lt;/li&gt;
&lt;li&gt;&amp;ldquo;Web Application&amp;rdquo;
&lt;img src=&#34;http://darrelltunnell.net/img/new aspnet project 2.PNG&#34; alt=&#34;new aspnet project 2.PNG&#34; /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;project-structure&#34;&gt;Project Structure&lt;/h3&gt;

&lt;p&gt;At this point, with the project created, let&amp;rsquo;s stop and appreciate some noteworthy files in our new project.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://darrelltunnell.net/img/asp net project sol explorer.PNG&#34; alt=&#34;asp net project sol explorer.PNG&#34; /&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;project.json&lt;/code&gt; - this is the new form of the project file. It replaces for example the older &lt;code&gt;.csproj&lt;/code&gt; and &lt;code&gt;.vbproj&lt;/code&gt; files.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;package.json&lt;/code&gt; - this file is managed by &lt;a href=&#34;https://docs.npmjs.com/&#34;&gt;NPM&lt;/a&gt;. It records the dependencies that your application has on NPM packages. More on NPM later.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;bower.json&lt;/code&gt; - this file is managed by &lt;a href=&#34;http://bower.io/&#34;&gt;Bower&lt;/a&gt;. It records the dependencies that your application has on Bower packages. More on Bower later.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;gulpfile.js&lt;/code&gt; - this file contains &lt;code&gt;tasks&lt;/code&gt; that can be executed by &lt;a href=&#34;http://gulpjs.com/&#34;&gt;Gulp&lt;/a&gt; as part of your development workflow, for example, whenever the project is built, cleaned etc. More on this later.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Startup.cs&lt;/code&gt; this is the entry point for your application. For the purposes of this article, the default code is fine and we won&amp;rsquo;t be amending anything in this file. It contains bootstrapping code such as setting up and registering services such as authentication.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;npm-it-s-an-important-citizen&#34;&gt;NPM - it&amp;rsquo;s an important citizen&lt;/h4&gt;

&lt;p&gt;&lt;a href=&#34;https://docs.npmjs.com/&#34;&gt;NPM&lt;/a&gt; is now a first class citizen of an ASP.NET 5 project. This is why you have a &lt;code&gt;package.json&lt;/code&gt; file in your project.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://darrelltunnell.net/img/packages json file.PNG&#34; alt=&#34;packages json file.PNG&#34; /&gt;&lt;/p&gt;

&lt;p&gt;NPM is a package manager - the Node Package Manager to be precise. Think &lt;code&gt;NuGet&lt;/code&gt; but for NodeJs packages. You could be forgiven for thinking it stands for &amp;ldquo;Not another Package Manager&amp;rdquo; - it doesn&amp;rsquo;t, I checked.&lt;/p&gt;

&lt;p&gt;If you aren&amp;rsquo;t yet familiar with NPM, stop here and do yourself a favour - go &lt;a href=&#34;https://docs.npmjs.com/&#34;&gt;get familiar&lt;/a&gt;, you will be seeing a lot of it in your ASP.NET 5 projects in the days to come!&lt;/p&gt;

&lt;h4 id=&#34;hold-on-another-package-manager-but-we-allready-have-nuget&#34;&gt;Hold on, another Package Manager? But we allready have NuGet?&lt;/h4&gt;

&lt;p&gt;NuGet is for .NET libraries like log4net silly. Npm has a vast array of packages not available through NuGet. Why wouldn&amp;rsquo;t you want to tap into those also?&lt;/p&gt;

&lt;h4 id=&#34;bower&#34;&gt;Bower&lt;/h4&gt;

&lt;p&gt;Here is where things get a tiny bit confusing. Bower is a package, that is also another package manager. I am tempted to move on.. but I&amp;rsquo;ll explain.&lt;/p&gt;

&lt;p&gt;Bower is a NodeJs program, and is therefore distributed as a NodeJs package, via &lt;code&gt;NPM&lt;/code&gt;. However it&amp;rsquo;s purpose in life is to be a package manager, but specifically for client (website) dependencies such as javascript or css. Think Jquery. If you want to add Jquery, or Bootstrap, or any other client side library to your project, then Bower would be the package manager to use to achieve that. Not NPM (&lt;a href=&#34;https://www.npmjs.com/package/jquery&#34;&gt;although you could&lt;/a&gt;), and not NuGet (&lt;a href=&#34;https://www.nuget.org/packages/jQuery/&#34;&gt;although you could&lt;/a&gt;). The ASP.NET team thinks &lt;code&gt;Bower&lt;/code&gt; is the package manager to use as Bower specialises for client dependencies - so the ASP.NET 5 project is set up by default to use Bower and you may allready see some Bower packages downloaded into your &lt;code&gt;bower_components&lt;/code&gt; folder within your project. The &lt;code&gt;bower.json&lt;/code&gt; file keeps track of your bower dependencies.&lt;/p&gt;

&lt;p&gt;However, in this walkthrough, we shall be scrapping &lt;code&gt;Bower&lt;/code&gt; and using a different package manager for our JQueries and our Bootstraps. One called &lt;a href=&#34;http://jspm.io/&#34;&gt;Jspm&lt;/a&gt;. Jspm is recomended for it&amp;rsquo;s additional capabilities, mainly that it provides not just package management features (at dev time) but package loading features, that your application uses at runtime.&lt;/p&gt;

&lt;h4 id=&#34;gulp&#34;&gt;Gulp&lt;/h4&gt;

&lt;p&gt;&lt;a href=&#34;http://gulpjs.com/&#34;&gt;Gulp&lt;/a&gt; is what all the cool kids are using to automate their development workflows.&lt;/p&gt;

&lt;p&gt;Gulp basically lets you define &lt;code&gt;tasks&lt;/code&gt; in a javascript file (gulpfile.js) that can then be run at an appropirate point. VS 2015 has a &lt;code&gt;Task Runner Explorer&lt;/code&gt; window in which you can pick which Gulp tasks (the ones defined in your gulpfile.js) that you would like to run and when. For example, you can have your gulp task executed whenever the project is built, or cleaned etc. You can also execute your gulp task via the command line (see the Gulp docs)&lt;/p&gt;

&lt;p&gt;We are going to write some Gulp tasks in gulpfile.js, and have them executed as part of the our project&amp;rsquo;s build process. These tasks are going to automatically handle bundling and minification of our javascript files for us.&lt;/p&gt;

&lt;p&gt;Our web application is going to reference the &amp;ldquo;bundle&amp;rdquo; of javascript that gulp outputs, rather than the individual javascript files that we download using jspm. Which means our application is going to be nice and optimised as the browser will have to do less roundtrips with the server (network requests) to load the required javascript.&lt;/p&gt;

&lt;h4 id=&#34;but-won-t-bundling-and-minification-lead-to-a-poor-debugging-experience&#34;&gt;But won&amp;rsquo;t bundling and minification lead to a poor debugging experience?&lt;/h4&gt;

&lt;p&gt;Not if sourcemaps are enabled. I will show you how to enable this. This will mean the browser will be requesting and running the optimised bundle of javascript - but you the developer, will be stepping through and reading the original source code in your browser&amp;rsquo;s dev tools, thanks to the magical power of source maps.&lt;/p&gt;

&lt;p&gt;However, I will also show you what to do if you just don&amp;rsquo;t want to bundle / minify your javascript during development (not all browsers will support source maps yet). If bundling and minification is something you only want to do at the time of a release build - which is pretty sensible - then I&amp;rsquo;ll cover that too.&lt;/p&gt;

&lt;h3 id=&#34;stay-tuned&#34;&gt;Stay tuned&lt;/h3&gt;

&lt;p&gt;In the next post/s, we will begin modifying our ASP.NET 5 project to do the things I have discussed:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;http://darrelltunnell.net/blog/2016/01/24/aurelia-and-asp-net-5-mvc-part2/&#34;&gt;Replace Bower with JSPM&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Bring in Aurelia&lt;/li&gt;
&lt;li&gt;Get an Aurelia application working on the Index.cshtml page&lt;/li&gt;
&lt;li&gt;Enable bundling and minification via a Gulp task&lt;/li&gt;
&lt;li&gt;Enable automatic browser refresh&lt;/li&gt;
&lt;li&gt;Disable bundling when our application is running in development (to maintain an easy debugging experience should your browser not support source maps)&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;If there is anything else you would like me to cover in this series, drop me a comment below!&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>ASP.NET 5 (vNext) Projects - Your NuGet Package May Fail to Install Correctly</title>
      <link>http://darrelltunnell.net/blog/2015/01/18/asp.net-5-vnext-projects---your-nuget-package-may-fail-to-install-correctly/</link>
      <pubDate>Sun, 18 Jan 2015 00:00:00 +0000</pubDate>
      
      <guid>http://darrelltunnell.net/blog/2015/01/18/asp.net-5-vnext-projects---your-nuget-package-may-fail-to-install-correctly/</guid>
      <description>&lt;h3 id=&#34;don-t-assume-nuget-packages-that-you-have-authored-will-continue-to-work-with-asp-net-5-vnext-projects&#34;&gt;Don&amp;rsquo;t assume NuGet Packages that you have authored will continue to work with ASP.NET 5 (vNext) projects.&lt;/h3&gt;

&lt;p&gt;Over the past year or so, I have authored &lt;a href=&#34;https://www.nuget.org/packages?q=darrell.tunnell&#34;&gt;a number of NuGet packages&lt;/a&gt; - because, well&amp;hellip; I am just an all around great guy.&lt;/p&gt;

&lt;p&gt;Recently, &lt;a href=&#34;http://stackoverflow.com/questions/27762659/error-while-adding-nuget-package-to-asp-net-vnext-project#comment44383264_27762659&#34;&gt;I was contacted by someone&lt;/a&gt; who was trying to use one of my NuGet packages with an ASP.NET vNext project (Preview release). Not something I have tried before - and this is where things get a little interesting.
&lt;/p&gt;

&lt;h3 id=&#34;when-nuget-packages-are-installed-into-an-asp-net-vnext-project-powershell-scripts-included-in-the-package-are-not-run&#34;&gt;When NuGet packages are installed into an ASP.NET vNext project - powershell scripts included in the package, are not run.&lt;/h3&gt;

&lt;p&gt;As most NuGet package authors will already know, it&amp;rsquo;s a &lt;a href=&#34;http://docs.nuget.org/docs/creating-packages/creating-and-publishing-a-package#Automatically_Running_PowerShell_Scripts_During_Package_Installation_and_Removal&#34;&gt;standard feature of NuGet&lt;/a&gt; that you can include powershell scripts within your NuGet package, that will then be executed when your package is installed (or uninstalled) into a visual studio project / solution.&lt;/p&gt;

&lt;p&gt;Many NuGet packages out there currently rely on this feature - else they will not work.&lt;/p&gt;

&lt;p&gt;Well, the issue with my NuGet package failing to install into an ASP.NET vNext project  was eventually posted on the asp.net forums, and &lt;a href=&#34;http://forums.asp.net/members/davidfowl.aspx&#34;&gt;David Fowler&lt;/a&gt; (who&amp;rsquo;s on the ASP.NET team) - kindly responded with some insight into the matter. He seems to suggest that &lt;a href=&#34;http://forums.asp.net/t/2027698.aspx?Error+while+adding+NuGet+package+to+ASP+NET+vNext+project&#34;&gt;ASP.NET v5 does not support running the packages powershell scripts when you install a NuGet package into an ASP.NET v5 project.&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I wanted to confirm that with him a second time - because &lt;strong&gt;that&amp;rsquo;s a huge problem for some of my NuGet packages&lt;/strong&gt;, but as you will see from that thread, I am still awaiting a secondary confirmation of this - although his first answer seems pretty clear cut.&lt;/p&gt;

&lt;h3 id=&#34;surely-this-is-documented-somewhere-or-perhaps-asp-net-5-offers-an-alternative-mechanism-for-running-tasks-on-installation-uninstallation-of-a-nuget-package&#34;&gt;Surely this is documented somewhere - or perhaps ASP.NET 5 offers an alternative mechanism for running tasks on installation / uninstallation of a NuGet package?&lt;/h3&gt;

&lt;p&gt;I have tried to look for more information. At the moment all I have to go on is David Fowlers response. Perhaps this is because there is still work in progress in this area, who knows. All I can suggest is that if your NuGet package currently requires custom tasks to be performed and you are using an &lt;code&gt;init&lt;/code&gt;, &lt;code&gt;install&lt;/code&gt; or &lt;code&gt;uninstall&lt;/code&gt; ps1 script - then be prepared for the fact that it may not work with ASP.NET 5 projects - and also be prepared for the fact that there may not be any workaround either. I seriously hope this is false speculation on my part - but if this does turn out the be true after ASP.NET 5 is released, I&amp;rsquo;ll be left with a slightly bitter taste in my mouth.&lt;/p&gt;

&lt;h3 id=&#34;so-where-from-here&#34;&gt;So where from here?&lt;/h3&gt;

&lt;p&gt;I am generally really excited about ASP.NET 5. I love what the team are doing. However I beleive that the ASP.NET team really should put some guidance out there to the NuGet community, so that NuGet package authors can gain an understanding of how their packages might have to change to work in the context of ASP.NET 5 projects.&lt;/p&gt;

&lt;p&gt;At a minimum, if ASP.NET 5 will indeed no longer support the running of these powershell scripts, then it should atleast warn you that the package contains such scripts and that they will not be executed - which means the package may not beahve as desired.&lt;/p&gt;

&lt;p&gt;My hope is that David Fowler or someone from the ASP.NET team will offer a clarification, insight, or workaround for this issue that makes it a non issue. Fingers crossed.&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>